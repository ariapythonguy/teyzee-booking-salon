<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Salon Appointment</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .container { max-width: 600px; margin: 0 auto; background: white; min-height: 100vh; }
        .header { background: #000; color: white; padding: 20px; text-align: center; position: sticky; top: 0; z-index: 100; }
        .header h1 { font-size: 1.8rem; margin-bottom: 5px; }
        .header p { opacity: 0.9; }
        .content { padding: 20px; }
        
        .form-group { margin-bottom: 20px; }
        .form-label { display: block; margin-bottom: 8px; font-weight: bold; color: #333; }
        .form-input, .form-select, .form-textarea { 
            width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; 
            font-size: 16px; transition: border-color 0.3s;
        }
        .form-input:focus, .form-select:focus, .form-textarea:focus { 
            outline: none; border-color: #667eea; 
        }
        
        .services { display: grid; gap: 12px; margin: 15px 0; }
        .service { 
            padding: 15px; border: 2px solid #e0e0e0; border-radius: 10px; cursor: pointer; 
            display: flex; justify-content: space-between; align-items: center; transition: all 0.3s;
            background: white;
        }
        .service:hover { border-color: #667eea; background: #f8f9ff; }
        .service.selected { border-color: #667eea; background: #667eea; color: white; }
        .service-info h4 { margin-bottom: 5px; }
        .service-info p { font-size: 0.9rem; opacity: 0.8; }
        .service-price { font-size: 1.2rem; font-weight: bold; }
        
        .calendar-nav { display: flex; justify-content: center; align-items: center; gap: 20px; margin: 20px 0; }
        .nav-btn { 
            background: #667eea; color: white; border: none; border-radius: 50%; 
            width: 40px; height: 40px; cursor: pointer; font-size: 1.2rem; 
        }
        .calendar-month { font-size: 1.3rem; font-weight: bold; }
        
        .calendar { display: grid; grid-template-columns: repeat(7, 1fr); gap: 8px; margin: 20px 0; }
        .calendar-header { 
            text-align: center; font-weight: bold; padding: 10px; 
            background: #f0f0f0; border-radius: 5px; font-size: 0.9rem; 
        }
        .calendar-day { 
            aspect-ratio: 1; display: flex; align-items: center; justify-content: center; 
            border: 1px solid #ddd; border-radius: 8px; cursor: pointer; 
            transition: all 0.3s; background: white;
        }
        .calendar-day:hover { background: #667eea; color: white; }
        .calendar-day.selected { background: #667eea; color: white; font-weight: bold; }
        .calendar-day.disabled { background: #f5f5f5; color: #ccc; cursor: not-allowed; }
        .calendar-day.today { border: 2px solid #667eea; }
        
        .time-slots { 
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin: 15px 0; 
            max-height: 200px; overflow-y: auto; 
        }
        .time-slot { 
            padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; 
            text-align: center; cursor: pointer; transition: all 0.3s; background: white;
        }
        .time-slot:hover { border-color: #667eea; background: #f8f9ff; }
        .time-slot.selected { background: #667eea; color: white; border-color: #667eea; }
        .time-slot.disabled { background: #f5f5f5; color: #ccc; cursor: not-allowed; }
        
        .booking-summary { 
            background: linear-gradient(135deg, #f8f9ff 0%, #e8ecff 100%); 
            padding: 20px; border-radius: 12px; margin: 20px 0; 
            border-left: 4px solid #667eea;
        }
        .booking-summary h3 { margin-bottom: 15px; color: #333; }
        .summary-row { display: flex; justify-content: space-between; margin-bottom: 8px; }
        .summary-row.total { font-weight: bold; font-size: 1.1rem; border-top: 1px solid #ddd; padding-top: 8px; }
        
        .book-btn { 
            width: 100%; padding: 16px; background: linear-gradient(135deg, #28a745 0%, #20c997 100%); 
            color: white; border: none; border-radius: 10px; font-size: 18px; font-weight: bold; 
            cursor: pointer; transition: all 0.3s; margin-top: 20px;
        }
        .book-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(40, 167, 69, 0.4); }
        .book-btn:disabled { background: #ccc; cursor: not-allowed; transform: none; box-shadow: none; }
        
        .back-link { 
            display: inline-block; margin-top: 20px; padding: 10px 20px; 
            background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 8px; 
            text-decoration: none; color: #333; text-align: center; width: 100%;
        }
        
        .section-title { 
            font-size: 1.2rem; font-weight: bold; margin: 25px 0 15px 0; 
            padding-bottom: 8px; border-bottom: 2px solid #667eea; 
        }
        
        @media (max-width: 768px) { 
            .time-slots { grid-template-columns: repeat(2, 1fr); }
            .calendar { gap: 4px; }
            .header h1 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-cut"></i> Book Salon Appointment</h1>
            <p>Professional beauty services at your convenience</p>
        </div>

        <div class="content">
            <div class="form-group">
                <div class="section-title">Choose Your Service</div>
                <div class="services" id="services"></div>
            </div>

            <div class="form-group">
                <div class="section-title">Select Date</div>
                <div class="calendar-nav">
                    <button class="nav-btn" onclick="changeMonth(-1)">❮</button>
                    <span class="calendar-month" id="calendar-month"></span>
                    <button class="nav-btn" onclick="changeMonth(1)">❯</button>
                </div>
                <div class="calendar" id="calendar"></div>
            </div>

            <div class="form-group" id="time-section" style="display:none;">
                <div class="section-title">Available Time Slots</div>
                <div class="time-slots" id="time-slots"></div>
            </div>

            <div class="form-group">
                <label class="form-label"><i class="fas fa-user"></i> Your Name</label>
                <input type="text" class="form-input" id="name" placeholder="Enter your full name" required>
            </div>

            <div class="form-group">
                <label class="form-label"><i class="fas fa-phone"></i> Phone Number</label>
                <input type="tel" class="form-input" id="phone" placeholder="Enter your phone number" required>
            </div>

            <div class="form-group">
                <label class="form-label"><i class="fas fa-envelope"></i> Email Address</label>
                <input type="email" class="form-input" id="email" placeholder="Enter your email address" required>
            </div>

            <div class="form-group">
                <label class="form-label"><i class="fas fa-comment"></i> Special Requests (Optional)</label>
                <textarea class="form-textarea" id="requests" rows="3" placeholder="Any special requirements or preferences..."></textarea>
            </div>

            <div class="booking-summary" id="summary" style="display:none;">
                <h3><i class="fas fa-clipboard-list"></i> Appointment Summary</h3>
                <div id="summary-content"></div>
            </div>

            <button class="book-btn" onclick="submitBooking()" disabled id="book-btn">
                <i class="fas fa-calendar-check"></i> Confirm Appointment
            </button>

            <a href="index.html" class="back-link">
                <i class="fas fa-arrow-left"></i> Back to Store
            </a>
        </div>
    </div>

    <script>
        let selectedService = null;
        let selectedDate = null;
        let selectedTime = null;
        let currentMonth = new Date();

        const salonServices = [
            {id: 1, name: 'IsBeautiful Signature Facial', duration: 90, price: 1800, category: 'Skin Care'},
            {id: 2, name: 'Professional Haircut & Style', duration: 60, price: 1200, category: 'Hair Care'},
            {id: 3, name: 'Hair Color & Treatment', duration: 120, price: 2500, category: 'Hair Care'},
            {id: 4, name: 'Luxury Manicure', duration: 45, price: 800, category: 'Nail Care'},
            {id: 5, name: 'Spa Pedicure', duration: 60, price: 1000, category: 'Nail Care'},
            {id: 6, name: 'Deep Hair Spa Treatment', duration: 90, price: 1500, category: 'Hair Care'},
            {id: 7, name: 'Eyebrow Shaping & Threading', duration: 30, price: 300, category: 'Skin Care'},
            {id: 8, name: 'Full Body Relaxation Massage', duration: 120, price: 3000, category: 'Body Care'}
        ];

        const timeSlots = [
            '09:00', '09:30', '10:00', '10:30', '11:00', '11:30',
            '12:00', '12:30', '14:00', '14:30', '15:00', '15:30',
            '16:00', '16:30', '17:00', '17:30', '18:00', '18:30'
        ];

        function loadServices() {
            const container = document.getElementById('services');
            container.innerHTML = '';
            
            salonServices.forEach(service => {
                const div = document.createElement('div');
                div.className = 'service';
                div.onclick = () => selectService(service);
                div.innerHTML = `
                    <div class="service-info">
                        <h4>${service.name}</h4>
                        <p>${service.duration} minutes • ${service.category}</p>
                    </div>
                    <div class="service-price">₹${service.price}</div>
                `;
                container.appendChild(div);
            });
        }

        function selectService(service) {
            selectedService = service;
            document.querySelectorAll('.service').forEach(s => s.classList.remove('selected'));
            event.target.closest('.service').classList.add('selected');
            updateSummary();
        }

        function generateCalendar() {
            const container = document.getElementById('calendar');
            const monthElement = document.getElementById('calendar-month');
            
            const year = currentMonth.getFullYear();
            const month = currentMonth.getMonth();
            
            monthElement.textContent = currentMonth.toLocaleDateString('en-US', { 
                month: 'long', 
                year: 'numeric' 
            });

            const firstDay = new Date(year, month, 1);
            const lastDay = new Date(year, month + 1, 0);
            const today = new Date();
            
            container.innerHTML = '';
            
            // Headers
            ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'].forEach(day => {
                const div = document.createElement('div');
                div.className = 'calendar-header';
                div.textContent = day;
                container.appendChild(div);
            });

            // Calculate start date for calendar display
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());

            // Generate calendar days
            for (let i = 0; i < 42; i++) {
                const date = new Date(startDate);
                date.setDate(date.getDate() + i);
                
                const div = document.createElement('div');
                div.className = 'calendar-day';
                div.textContent = date.getDate();
                
                // Check if date is today
                if (date.toDateString() === today.toDateString()) {
                    div.classList.add('today');
                }
                
                // Disable past dates and salon closed days (Sunday)
                if (date < today.setHours(0,0,0,0) || date.getDay() === 0 || date.getMonth() !== month) {
                    div.classList.add('disabled');
                } else {
                    div.onclick = () => selectDate(date);
                }
                
                // Fade out other month dates
                if (date.getMonth() !== month) {
                    div.style.opacity = '0.3';
                }
                
                container.appendChild(div);
            }
        }

        function changeMonth(delta) {
            currentMonth.setMonth(currentMonth.getMonth() + delta);
            generateCalendar();
        }

        function selectDate(date) {
            selectedDate = date;
            selectedTime = null; // Reset time when date changes
            
            document.querySelectorAll('.calendar-day').forEach(d => d.classList.remove('selected'));
            event.target.classList.add('selected');
            
            document.getElementById('time-section').style.display = 'block';
            loadTimeSlots();
            updateSummary();
        }

        function loadTimeSlots() {
            const container = document.getElementById('time-slots');
            container.innerHTML = '';
            
            timeSlots.forEach(time => {
                const div = document.createElement('div');
                div.className = 'time-slot';
                div.textContent = time;
                
                // Simulate some booked slots (you can integrate with real availability)
                if (Math.random() < 0.15) { // 15% chance of being booked
                    div.classList.add('disabled');
                    div.title = 'This slot is already booked';
                } else {
                    div.onclick = () => selectTime(time);
                }
                
                container.appendChild(div);
            });
        }

        function selectTime(time) {
            selectedTime = time;
            document.querySelectorAll('.time-slot').forEach(t => t.classList.remove('selected'));
            event.target.classList.add('selected');
            updateSummary();
        }

        function updateSummary() {
            const summary = document.getElementById('summary');
            const summaryContent = document.getElementById('summary-content');
            const bookBtn = document.getElementById('book-btn');
            
            if (selectedService && selectedDate && selectedTime) {
                const endTime = calculateEndTime(selectedTime, selectedService.duration);
                
                summaryContent.innerHTML = `
                    <div class="summary-row">
                        <span><strong>Service:</strong></span>
                        <span>${selectedService.name}</span>
                    </div>
                    <div class="summary-row">
                        <span><strong>Date:</strong></span>
                        <span>${selectedDate.toLocaleDateString('en-IN', { 
                            weekday: 'long', 
                            year: 'numeric', 
                            month: 'long', 
                            day: 'numeric' 
                        })}</span>
                    </div>
                    <div class="summary-row">
                        <span><strong>Time:</strong></span>
                        <span>${selectedTime} - ${endTime}</span>
                    </div>
                    <div class="summary-row">
                        <span><strong>Duration:</strong></span>
                        <span>${selectedService.duration} minutes</span>
                    </div>
                    <div class="summary-row total">
                        <span><strong>Total Amount:</strong></span>
                        <span>₹${selectedService.price}</span>
                    </div>
                `;
                
                summary.style.display = 'block';
                bookBtn.disabled = false;
            } else {
                summary.style.display = 'none';
                bookBtn.disabled = true;
            }
        }

        function calculateEndTime(startTime, duration) {
            const [hours, minutes] = startTime.split(':').map(Number);
            const date = new Date();
            date.setHours(hours, minutes);
            date.setMinutes(date.getMinutes() + duration);
            return date.toTimeString().slice(0, 5);
        }

        function submitBooking() {
            const name = document.getElementById('name').value.trim();
            const phone = document.getElementById('phone').value.trim();
            const email = document.getElementById('email').value.trim();
            const requests = document.getElementById('requests').value.trim();
            
            if (!name || !phone || !email) {
                alert('Please fill in all required fields (Name, Phone, Email)');
                return;
            }
            
            if (!validateEmail(email)) {
                alert('Please enter a valid email address');
                return;
            }
            
            if (!validatePhone(phone)) {
                alert('Please enter a valid phone number');
                return;
            }
            
            const endTime = calculateEndTime(selectedTime, selectedService.duration);
            
            let message = `💇‍♀️ SALON APPOINTMENT BOOKING\n\n`;
            message += `👤 Customer: ${name}\n`;
            message += `📱 Phone: ${phone}\n`;
            message += `📧 Email: ${email}\n\n`;
            message += `✨ Service: ${selectedService.name}\n`;
            message += `📅 Date: ${selectedDate.toLocaleDateString('en-IN', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            })}\n`;
            message += `🕐 Time: ${selectedTime} - ${endTime}\n`;
            message += `⏰ Duration: ${selectedService.duration} minutes\n`;
            message += `💰 Amount: ₹${selectedService.price}\n`;
            
            if (requests) {
                message += `\n📝 Special Requests:\n${requests}\n`;
            }
            
            message += `\n⏰ Booking Time: ${new Date().toLocaleString('en-IN')}`;
            
            // Replace with your actual WhatsApp number from store.json
            const whatsappNumber = '918291274240';
            const whatsappURL = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`;
            
            // Open WhatsApp
            window.open(whatsappURL, '_blank');
            
            // Create Google Calendar event
            setTimeout(() => createGoogleCalendarEvent(), 1000);
            
            alert('Appointment booking sent! Please check WhatsApp for confirmation.');
            
            // Reset form
            resetForm();
        }

        function validateEmail(email) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return emailRegex.test(email);
        }

        function validatePhone(phone) {
            const phoneRegex = /^[\d\s\+\-\(\)]{10,}$/;
            return phoneRegex.test(phone);
        }

        function createGoogleCalendarEvent() {
            const name = document.getElementById('name').value;
            const startDateTime = new Date(selectedDate);
            const [hours, minutes] = selectedTime.split(':').map(Number);
            startDateTime.setHours(hours, minutes);
            
            const endDateTime = new Date(startDateTime);
            endDateTime.setMinutes(endDateTime.getMinutes() + selectedService.duration);
            
            const title = `${selectedService.name} - ${name}`;
            const details = `Customer: ${name}\\nPhone: ${document.getElementById('phone').value}\\nEmail: ${document.getElementById('email').value}\\nService: ${selectedService.name}\\nDuration: ${selectedService.duration} minutes\\nPrice: ₹${selectedService.price}`;
            
            const formatDate = (date) => date.toISOString().replace(/[-:]/g, '').replace(/\.\d{3}/, '');
            const googleURL = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(title)}&dates=${formatDate(startDateTime)}/${formatDate(endDateTime)}&details=${encodeURIComponent(details)}`;
            
            window.open(googleURL, '_blank');
        }

        function resetForm() {
            selectedService = null;
            selectedDate = null;
            selectedTime = null;
            
            document.getElementById('name').value = '';
            document.getElementById('phone').value = '';
            document.getElementById('email').value = '';
            document.getElementById('requests').value = '';
            
            document.querySelectorAll('.service').forEach(s => s.classList.remove('selected'));
            document.querySelectorAll('.calendar-day').forEach(d => d.classList.remove('selected'));
            document.querySelectorAll('.time-slot').forEach(t => t.classList.remove('selected'));
            
            document.getElementById('time-section').style.display = 'none';
            updateSummary();
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadServices();
            generateCalendar();
        });
    </script>
</body>
</html>
